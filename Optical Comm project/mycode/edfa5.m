function pdot=edfa5(l,ps,Pp)
r=5e-06;
gammap=0.4;
gammas=0.8;
N=1e25;
A=pi.*r^2;
lamdap=1480e-09;
segmaep=0.7899e-25;
segmaap=1.950e-25;
lamdas=1550e-09;
segmaes=3.084e-25;
segmaas=2.277e-25;
lamdak=[1525 1530 1535 1540 1545 1550 1555 1560 1565]*10^-09;
segmaek=[3.983 4.752 4.147 3.416 3.24 3.084 2.945 2.773 2.353]*10^-25;
segmaak=[4.538 4.613 3.298 2.853 2.57 2.277 1.960 1.676 1.286]*10^-25;
PsindB=[0 0 0 0 0 0 0 0 0];
gammak=[gammas gammas gammas gammas gammas gammas gammas gammas gammas];
Ps=10.^(PsindB/10);
Pk=Ps;
Pp=0.5;
%Pp=[0.500000000000000;0.475501588881780;0.452203552571424;0.430047134749180;0.408976300507400;0.332940903906852;0.271054618377038;0.220803434186172;0.179893118975887;0.147826153416991;0.121480196310668;0.0998746445801843;0.0821196443993725;0.0674458907118246;0.0553964055749505;0.0455204363215927;0.0374088323766200;0.0307252523445030;0.0252368072880763;0.0207382412262495;0.0170432451341003;0.0139982217963249;0.0114977033289324;0.00944817424965625;0.00776475131383560;0.00637746629023026;0.00523825264104029;0.00430450559486206;0.00353755314821995;0.00290551814489302;0.00238650230714268;0.00196109527040523;0.00161167840504739;0.00132372876245113;0.00108726966724257;0.000893457926410223;0.000734266645770353;0.000603079296250651;0.000495350591710434;0.000407051650425186;0.000334525489307499;0.000271310757929106;0.000220052727439114;0.000178597768660929;0.000144975201100842;0.000113513016627280;8.88852762376025e-05;6.97213546750772e-05;5.47168903248058e-05;4.10480793200640e-05;3.07951489542817e-05;2.32126718739756e-05;1.75267426766898e-05;1.23645133184942e-05;8.71840933114433e-06;6.24591252782525e-06;4.50606735687164e-06;2.88361472257879e-06;1.83511265600745e-06;1.25210540220698e-06;8.85958697912715e-07;4.57429174318322e-07;2.18258438657693e-07;1.70835266919689e-07;1.58659394529633e-07;5.87931305923085e-08;9.50420067879448e-09;2.49613496528452e-08;4.04901789296355e-08;1.50041186314465e-08;2.42549007078047e-09;6.37018385684168e-09;1.03331705923523e-08;3.82907958189279e-09;6.18989674385594e-10;1.62568302332832e-09;2.63704476772594e-09;1.28747570503003e-09;5.54725432064757e-10;4.80163010918879e-10;4.95964811671717e-10];
t=10e-03;
c=3e8;
h=6.626e-34;
deltalamda=0.1e-09;
%for i=1:length(Pp)
con0=gammap.*lamdap.*segmaep.*Pp;
%end
con1=sum(gammak.*lamdak.*segmaek.*Pk);
con2=sum(gammak.*lamdak.*segmaak.*Pk);
%con1=sum(gammak.*lamdak.*segmaek.*Pk);
%con2=gammap.*lamdap.*segmaep.*Pp;
const0=(con0)./(A*h*c);
const1=(con1)/(A*h*c);
const2=(con2)/(A*h*c);
N2=(const2.*N)./((1/t)+const0+const1+const2);
N1=N-N2;
pdot(1)=(gammas.*((segmaes.*N2-segmaas.*N1).*ps(1)+...
        (2*h*c^2*segmaes.*N2.*deltalamda)/lamdas));
end